{% extends "layout.html" %}

{% block content %}

<!-- Header -->
<div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 mb-6 flex items-center justify-between">
    <div>
        <h2 class="text-lg font-bold text-[#0A2540]">একাউন্ট অ্যাক্টিভেশন</h2>
        <p class="text-xs text-[#E2136E] font-bold">স্ট্যাটাস চেক</p>
    </div>
    <a href="/dashboard" class="text-xs bg-gray-100 text-gray-600 px-3 py-2 rounded-lg hover:bg-gray-200 transition">
        <i class="fa-solid fa-arrow-left"></i> ব্যাক
    </a>
</div>

<!-- CASE 1: PENDING (অপেক্ষা করুন) -->
{% if request_data and request_data.status == 'pending' %}
<div class="bg-white rounded-2xl shadow-lg p-8 text-center border-t-4 border-yellow-400">
    <div class="h-20 w-20 bg-yellow-50 text-yellow-500 rounded-full flex items-center justify-center text-4xl mx-auto mb-4 animate-pulse">
        <i class="fa-solid fa-clock"></i>
    </div>
    <h2 class="text-xl font-bold text-[#0A2540] mb-2">যাচাইকরণ চলছে...</h2>
    <p class="text-gray-500 text-sm mb-6">
        আপনার পেমেন্ট তথ্য আমাদের কাছে জমা আছে। এডমিন এটি যাচাই করছেন। দয়া করে কিছুক্ষণ অপেক্ষা করুন।
    </p>
    
    <!-- Submission Details -->
    <div class="bg-gray-50 rounded-xl p-4 text-left max-w-sm mx-auto space-y-2 text-sm border border-gray-200">
        <div class="flex justify-between">
            <span class="text-gray-500">Method:</span>
            <span class="font-bold">{{ request_data.method }}</span>
        </div>
        <div class="flex justify-between">
            <span class="text-gray-500">TrxID:</span>
            <span class="font-mono font-bold bg-white px-2 rounded border">{{ request_data.trx_id }}</span>
        </div>
        <div class="flex justify-between">
            <span class="text-gray-500">Date:</span>
            <span>{{ request_data.created_at[:10] }}</span>
        </div>
    </div>
    
    <div class="mt-6">
        <a href="/dashboard" class="text-[#0057FF] text-sm font-bold hover:underline">ড্যাশবোর্ডে ফিরে যান</a>
    </div>
</div>

<!-- CASE 2: REJECTED (বাতিল হয়েছে) -->
{% elif request_data and request_data.status == 'rejected' %}
<div class="bg-red-50 rounded-2xl p-6 mb-6 border border-red-200 text-center">
    <i class="fa-solid fa-circle-xmark text-4xl text-red-500 mb-2"></i>
    <h3 class="font-bold text-red-700">আপনার রিকোয়েস্ট বাতিল হয়েছে</h3>
    <p class="text-xs text-red-500 mb-4">সম্ভবত TrxID ভুল ছিল অথবা টাকা পাওয়া যায়নি। আবার চেষ্টা করুন।</p>
    
    <!-- ফর্ম আবার দেখানোর জন্য আমরা নিচের ব্লকে চলে যাব (Else Block নেই, তাই নিচে ফর্ম আবার আসবে) -->
</div>
{% endif %}


<!-- CASE 3: NO REQUEST / REJECTED (ফর্ম দেখাবে) -->
{% if not request_data or request_data.status == 'rejected' %}

<!-- পেমেন্ট ইনফো -->
<div class="bg-gradient-to-r from-[#0A2540] to-[#1a3b5c] text-white rounded-2xl shadow-lg p-6 mb-6 relative overflow-hidden">
    <div class="absolute -right-6 -top-6 bg-white/10 h-32 w-32 rounded-full blur-2xl"></div>
    <h3 class="font-bold text-sm mb-2 opacity-80">ফি: ৩০ টাকা</h3>
    <div class="bg-white/10 p-3 rounded-lg flex justify-between items-center backdrop-blur-sm border border-white/10">
        <div>
            <p class="text-xs text-gray-300">Send Money Number</p>
            <p class="text-xl font-mono font-bold tracking-wider" id="payNumber">01912107604</p>
        </div>
        <button onclick="copyNumber()" class="bg-white text-[#0A2540] px-3 py-1.5 rounded text-xs font-bold active:scale-95 transition">
            Copy
        </button>
    </div>
</div>

<!-- ফর্ম -->
<div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
    <h3 class="font-bold text-[#0A2540] mb-6 border-b pb-2">পেমেন্ট তথ্য দিন</h3>

    <form method="POST" action="/activate/submit" class="space-y-5">
        
        <!-- Method -->
        <div>
            <label class="block text-xs font-bold text-gray-700 mb-2 uppercase">পেমেন্ট মেথড</label>
            <div class="grid grid-cols-3 gap-3">
                <label class="cursor-pointer">
                    <input type="radio" name="method" value="bKash" class="peer sr-only" checked>
                    <div class="py-2 border rounded-lg text-center peer-checked:bg-pink-600 peer-checked:text-white transition text-xs font-bold">bKash</div>
                </label>
                <label class="cursor-pointer">
                    <input type="radio" name="method" value="Nagad" class="peer sr-only">
                    <div class="py-2 border rounded-lg text-center peer-checked:bg-orange-500 peer-checked:text-white transition text-xs font-bold">Nagad</div>
                </label>
                <label class="cursor-pointer">
                    <input type="radio" name="method" value="Rocket" class="peer sr-only">
                    <div class="py-2 border rounded-lg text-center peer-checked:bg-purple-600 peer-checked:text-white transition text-xs font-bold">Rocket</div>
                </label>
            </div>
        </div>

        <!-- Sender -->
        <div>
            <label class="block text-xs font-bold text-gray-700 mb-1">সেন্ডার নম্বর</label>
            <input type="number" name="sender_number" required placeholder="01xxxxxxxxx" 
                   class="w-full p-3 border rounded-xl focus:border-[#0A2540] bg-gray-50 text-sm">
        </div>

        <!-- TrxID -->
        <div>
            <label class="block text-xs font-bold text-gray-700 mb-1">TrxID</label>
            <input type="text" name="trx_id" required placeholder="Example: 9H56..." 
                   class="w-full p-3 border rounded-xl focus:border-[#0A2540] bg-gray-50 text-sm uppercase">
        </div>

        <button type="submit" class="w-full bg-[#E2136E] text-white py-3.5 rounded-xl font-bold shadow-lg hover:bg-pink-700 transition">
            তথ্য জমা দিন
        </button>
    </form>
</div>
{% endif %}

<script>
    function copyNumber() {
        const num = document.getElementById('payNumber').innerText;
        navigator.clipboard.writeText(num);
        alert('Copied: ' + num);
    }
</script>

{% endblock %}
